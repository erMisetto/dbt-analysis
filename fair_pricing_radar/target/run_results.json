{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-25T08:29:28.322951Z", "invocation_id": "90714278-f9b3-48d8-a8bf-9599c7312ac9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T08:29:20.885851Z", "completed_at": "2025-04-25T08:29:20.895824Z"}, {"name": "execute", "started_at": "2025-04-25T08:29:20.895824Z", "completed_at": "2025-04-25T08:29:27.284728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.399874687194824, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbebde-0305-0bba-0006-8fdb0018fc6e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.fair_pricing_radar.mart_route_map_data", "compiled": true, "compiled_code": "\n\nWITH route_metrics AS (\n    SELECT \n        f.ROUTE,\n        SPLIT_PART(f.ROUTE, '-', 1) AS ORIGIN,\n        SPLIT_PART(f.ROUTE, '-', 2) AS DESTINATION,\n        COUNT(*) AS TOTAL_BOOKINGS,\n        SUM(CASE WHEN f.R1_PRICE_OUTLIER = 1 OR f.R2_SEAT_SCARCITY = 1 OR f.R3_MONOPOLY_PREMIUM = 1 \n            THEN 1 ELSE 0 END) AS FLAGGED_BOOKINGS,\n        ROUND(100 * SUM(CASE WHEN f.R1_PRICE_OUTLIER = 1 OR f.R2_SEAT_SCARCITY = 1 OR f.R3_MONOPOLY_PREMIUM = 1 \n            THEN 1 ELSE 0 END) / COUNT(*), 1) AS PCT_FLAGGED\n    FROM FLIGHT_PRICES.WALRUS_PUBLIC.mart_pricing_features f\n    GROUP BY f.ROUTE\n),\nroute_comp AS (\n    SELECT \n        r.ROUTE,\n        r.HHI,\n        CASE \n            WHEN r.HHI >= 0.8 THEN 'High Concentration'\n            WHEN r.HHI >= 0.5 THEN 'Moderate Concentration'\n            ELSE 'Low Concentration'\n        END AS CONCENTRATION_LEVEL\n    FROM FLIGHT_PRICES.WALRUS_PUBLIC.int_route_competition r\n),\nairport_geo AS (\n    SELECT \n        IATA_CODE,\n        LAT_DEG AS AIRPORT_LAT,\n        LON_DEG AS AIRPORT_LON\n    FROM FLIGHT_PRICES.WALRUS_PUBLIC.seed_airport_geo\n)\nSELECT \n    m.ROUTE,\n    m.ORIGIN,\n    m.DESTINATION,\n    m.TOTAL_BOOKINGS,\n    m.FLAGGED_BOOKINGS,\n    m.PCT_FLAGGED,\n    c.HHI,\n    c.CONCENTRATION_LEVEL,\n    o.AIRPORT_LAT AS ORIGIN_LAT,\n    o.AIRPORT_LON AS ORIGIN_LON,\n    d.AIRPORT_LAT AS DESTINATION_LAT,\n    d.AIRPORT_LON AS DESTINATION_LON\nFROM route_metrics m\nLEFT JOIN route_comp c ON m.ROUTE = c.ROUTE\nLEFT JOIN airport_geo o ON m.ORIGIN = o.IATA_CODE\nLEFT JOIN airport_geo d ON m.DESTINATION = d.IATA_CODE\nWHERE o.AIRPORT_LAT IS NOT NULL \n  AND o.AIRPORT_LON IS NOT NULL\n  AND d.AIRPORT_LAT IS NOT NULL \n  AND d.AIRPORT_LON IS NOT NULL", "relation_name": "FLIGHT_PRICES.WALRUS_PUBLIC.mart_route_map_data", "batch_results": null}], "elapsed_time": 21.414698362350464, "args": {"defer": false, "version_check": true, "macro_debugging": false, "printer_width": 80, "select": ["mart_route_map_data"], "require_yaml_configuration_for_mf_time_spines": false, "require_nested_cumulative_type_params": false, "cache_selected_only": false, "log_format_file": "debug", "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "print": true, "quiet": false, "log_level": "info", "log_level_file": "debug", "profiles_dir": "C:\\Users\\Mattia\\.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "write_json": true, "source_freshness_run_project_hooks": false, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "strict_mode": false, "populate_cache": true, "partial_parse": true, "use_colors": true, "introspect": true, "invocation_command": "dbt run --select mart_route_map_data", "which": "run", "log_file_max_bytes": 10485760, "empty": false, "exclude": [], "require_resource_names_without_spaces": false, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "static_parser": true, "use_colors_file": true, "log_path": "C:\\Users\\Mattia\\Business_Challenge\\fair_pricing_radar\\logs", "project_dir": "C:\\Users\\Mattia\\Business_Challenge\\fair_pricing_radar", "favor_state": false, "state_modified_compare_more_unrendered_values": false, "partial_parse_file_diff": true}}